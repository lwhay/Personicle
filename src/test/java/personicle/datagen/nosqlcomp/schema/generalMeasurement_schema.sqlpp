USE Personicle;

DROP DATASET GeneralMeasurement IF EXISTS;

DROP TYPE GeneralMeasurementType IF EXISTS;

CREATE TYPE GeneralMeasurementType AS OPEN {
  measureId: UUID,
  measure: string,  --primary key string for measurement, UUID
  deviceId: string,
  timestamp: bigint,
  userName: string?,
  startAt: datetime?,
  endAt: datetime?,
  timerange: interval,
  category: string,
  attribute: string?,
  activity: string?,
  description: string?
};

CREATE DATASET GeneralMeasurement(GeneralMeasurementType) PRIMARY KEY measureId autogenerated;
CREATE INDEX GeneralMeasurementMeasureIdx ON GeneralMeasurement(measure) type btree;
CREATE INDEX GeneralMeasurementTimeRangeIdIdx ON GeneralMeasurement(startAt, endAt) type btree;
CREATE INDEX GeneralMeasurementDeviceIdIdx ON GeneralMeasurement(deviceId, timestamp) type btree;
CREATE INDEX GeneralMeasurementAttributeIdx ON GeneralMeasurement(attribute) type fulltext;